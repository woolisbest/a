
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hgkf-Tube_v1</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ff0000;
            --light-bg: #ffffff;
            --light-secondary-bg: #f9f9f9;
            --light-text: #030303;
            --light-secondary-text: #606060;
            --light-border: #e0e0e0;
            --dark-bg: #0f0f0f;
            --dark-secondary-bg: #272727;
            --dark-text: #ffffff;
            --dark-secondary-text: #aaaaaa;
            --dark-border: #383838;
            --hover-color: #f2f2f2;
            --dark-hover-color: #272727;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--light-text);
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background-color: var(--dark-bg);
            color: var(--dark-text);
        }

        .container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* ヘッダースタイル */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            height: 56px;
            position: sticky;
            top: 0;
            z-index: 100;
            background-color: var(--light-bg);
            border-bottom: 1px solid var(--light-border);
            transition: background-color 0.3s, border-color 0.3s;
        }

        body.dark-mode header {
            background-color: var(--dark-bg);
            border-bottom: 1px solid var(--dark-border);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .menu-icon {
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
        }

        .menu-icon:hover {
            background-color: var(--hover-color);
        }

        body.dark-mode .menu-icon:hover {
            background-color: var(--dark-hover-color);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .logo-icon {
            color: var(--primary-color);
            font-size: 28px;
        }

        .logo-text {
            font-family: 'Roboto', Arial, sans-serif;
            font-weight: 700;
            font-size: 20px;
            letter-spacing: -1px;
        }

        .logo-subtitle {
            font-size: 10px;
            color: var(--light-secondary-text);
            margin-left: 5px;
        }

        body.dark-mode .logo-subtitle {
            color: var(--dark-secondary-text);
        }

        .header-center {
            display: flex;
            align-items: center;
            flex: 1;
            max-width: 640px;
            margin: 0 40px;
        }

        .search-container {
            display: flex;
            width: 100%;
        }

        .search-input {
            flex: 1;
            padding: 0 16px;
            height: 40px;
            border: 1px solid var(--light-border);
            border-radius: 40px 0 0 40px;
            background-color: var(--light-bg);
            color: var(--light-text);
            font-size: 16px;
            outline: none;
        }

        body.dark-mode .search-input {
            background-color: var(--dark-bg);
            border-color: var(--dark-border);
            color: var(--dark-text);
        }

        .search-btn {
            width: 64px;
            height: 40px;
            background-color: var(--light-secondary-bg);
            border: 1px solid var(--light-border);
            border-left: none;
            border-radius: 0 40px 40px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.dark-mode .search-btn {
            background-color: var(--dark-secondary-bg);
            border-color: var(--dark-border);
        }

        .search-btn i {
            font-size: 18px;
            color: var(--light-secondary-text);
        }

        body.dark-mode .search-btn i {
            color: var(--dark-secondary-text);
        }

        .filter-container {
            margin-top: 10px;
            padding: 0 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .date-filter {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }

        .date-filter select {
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid var(--light-border);
            background-color: var(--light-bg);
            color: var(--light-text);
            outline: none;
            cursor: pointer;
        }

        body.dark-mode .date-filter select {
            background-color: var(--dark-secondary-bg);
            border-color: var(--dark-border);
            color: var(--dark-text);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .theme-toggle {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--light-text);
            padding: 8px;
            border-radius: 50%;
        }

        body.dark-mode .theme-toggle {
            color: var(--dark-text);
        }

        .theme-toggle:hover {
            background-color: var(--hover-color);
        }

        body.dark-mode .theme-toggle:hover {
            background-color: var(--dark-hover-color);
        }

        .api-selector, .player-source-selector {
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid var(--light-border);
            background-color: var(--light-bg);
            color: var(--light-text);
            outline: none;
            cursor: pointer;
            font-size: 14px;
        }

        body.dark-mode .api-selector, 
        body.dark-mode .player-source-selector {
            background-color: var(--dark-secondary-bg);
            border-color: var(--dark-border);
            color: var(--dark-text);
        }

        /* メインコンテンツ */
        .main-content {
            display: flex;
            flex: 1;
        }

        /* サイドバー */
        .sidebar {
            width: 240px;
            padding: 12px;
            background-color: var(--light-bg);
            overflow-y: auto;
            position: sticky;
            top: 56px;
            height: calc(100vh - 56px);
            transition: background-color 0.3s;
            border-right: 1px solid var(--light-border);
        }

        body.dark-mode .sidebar {
            background-color: var(--dark-bg);
            border-right-color: var(--dark-border);
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            border-radius: 10px;
            cursor: pointer;
            margin-bottom: 4px;
        }

        .sidebar-item:hover {
            background-color: var(--hover-color);
        }

        body.dark-mode .sidebar-item:hover {
            background-color: var(--dark-hover-color);
        }

        .sidebar-item.active {
            background-color: rgba(255, 0, 0, 0.1);
        }

        body.dark-mode .sidebar-item.active {
            background-color: rgba(255, 0, 0, 0.2);
        }

        .sidebar-item i {
            font-size: 20px;
            margin-right: 24px;
            width: 24px;
            text-align: center;
        }

        .sidebar-item span {
            font-size: 14px;
        }

        /* コンテンツエリア */
        .content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: var(--light-secondary-bg);
            transition: background-color 0.3s;
        }

        body.dark-mode .content-area {
            background-color: var(--dark-bg);
        }

        /* 初期設定画面 */
        .setup-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            background-color: var(--light-bg);
            transition: background-color 0.3s;
        }

        body.dark-mode .setup-screen {
            background-color: var(--dark-bg);
        }

        .setup-container {
            max-width: 800px;
            width: 100%;
            background-color: var(--light-secondary-bg);
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s;
        }

        body.dark-mode .setup-container {
            background-color: var(--dark-secondary-bg);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .setup-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            font-weight: 500;
        }

        .setup-section {
            margin-bottom: 30px;
        }

        .setup-section-title {
            font-size: 18px;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .api-options, .player-source-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .api-option, .player-source-option {
            padding: 12px 16px;
            border: 2px solid var(--light-border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background-color: var(--light-bg);
        }

        body.dark-mode .api-option, 
        body.dark-mode .player-source-option {
            border-color: var(--dark-border);
            background-color: var(--dark-bg);
        }

        .api-option:hover, .player-source-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .api-option.selected, .player-source-option.selected {
            border-color: var(--primary-color);
            background-color: rgba(255, 0, 0, 0.05);
        }

        body.dark-mode .api-option.selected,
        body.dark-mode .player-source-option.selected {
            background-color: rgba(255, 0, 0, 0.1);
        }

        .option-number {
            display: inline-block;
            width: 24px;
            height: 24px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            margin-right: 10px;
            font-weight: 500;
        }

        .setup-btn {
            display: block;
            width: 100%;
            padding: 14px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.2s;
        }

        .setup-btn:hover {
            background-color: #cc0000;
        }

        .setup-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        /* ビデオグリッド */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .video-card {
            cursor: pointer;
            transition: transform 0.2s;
        }

        .video-card:hover {
            transform: translateY(-5px);
        }

        .thumbnail-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 12px;
            background-color: #000;
        }

        .video-thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-duration {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .video-info {
            display: flex;
            gap: 12px;
        }

        .channel-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
        }

        .video-details {
            flex: 1;
        }

        .video-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.4;
        }

        .channel-name {
            font-size: 14px;
            color: var(--light-secondary-text);
            margin-bottom: 4px;
        }

        body.dark-mode .channel-name {
            color: var(--dark-secondary-text);
        }

        .video-stats {
            font-size: 14px;
            color: var(--light-secondary-text);
        }

        body.dark-mode .video-stats {
            color: var(--dark-secondary-text);
        }

        /* プレイヤーページ */
        .player-page {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        @media (min-width: 1024px) {
            .player-page {
                flex-direction: row;
            }
        }

        .player-container {
            flex: 1;
        }

        .video-player {
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: 12px;
            overflow: hidden;
            background-color: #000;
            margin-bottom: 20px;
        }

        .player-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .video-description {
            background-color: var(--light-bg);
            padding: 16px;
            border-radius: 12px;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        body.dark-mode .video-description {
            background-color: var(--dark-secondary-bg);
        }

        .video-description-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 12px;
        }

        .video-description-text {
            font-size: 14px;
            line-height: 1.6;
            color: var(--light-secondary-text);
            white-space: pre-line;
        }

        body.dark-mode .video-description-text {
            color: var(--dark-secondary-text);
        }

        /* サイドバー（関連動画） */
        .related-videos {
            width: 100%;
        }

        @media (min-width: 1024px) {
            .related-videos {
                width: 400px;
            }
        }

        .section-title {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 16px;
        }

        .related-video-item {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            cursor: pointer;
        }

        .related-thumbnail {
            width: 168px;
            height: 94px;
            border-radius: 8px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .related-video-details {
            flex: 1;
        }

        .related-video-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.4;
        }

        .related-channel-name {
            font-size: 12px;
            color: var(--light-secondary-text);
            margin-bottom: 4px;
        }

        body.dark-mode .related-channel-name {
            color: var(--dark-secondary-text);
        }

        .related-video-stats {
            font-size: 12px;
            color: var(--light-secondary-text);
        }

        body.dark-mode .related-video-stats {
            color: var(--dark-secondary-text);
        }

        /* コメントセクション */
        .comments-section {
            margin-top: 30px;
        }

        .comments-count {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .comment {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-border);
        }

        body.dark-mode .comment {
            border-bottom-color: var(--dark-border);
        }

        .comment-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
        }

        .comment-content {
            flex: 1;
        }

        .comment-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .comment-author {
            font-size: 14px;
            font-weight: 500;
        }

        .comment-time {
            font-size: 12px;
            color: var(--light-secondary-text);
        }

        body.dark-mode .comment-time {
            color: var(--dark-secondary-text);
        }

        .comment-text {
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .comment-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .comment-action {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: var(--light-secondary-text);
            background: none;
            border: none;
            cursor: pointer;
        }

        body.dark-mode .comment-action {
            color: var(--dark-secondary-text);
        }

        .comment-action i {
            font-size: 14px;
        }

        .load-more-btn {
            display: block;
            margin: 30px auto;
            padding: 12px 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .load-more-btn:hover {
            background-color: #cc0000;
        }

        /* チャンネルページ */
        .channel-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-border);
        }

        body.dark-mode .channel-header {
            border-bottom-color: var(--dark-border);
        }

        .channel-avatar-large {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
        }

        .channel-info {
            flex: 1;
        }

        .channel-title {
            font-size: 24px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .channel-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 12px;
            font-size: 14px;
            color: var(--light-secondary-text);
        }

        body.dark-mode .channel-stats {
            color: var(--dark-secondary-text);
        }

        .channel-description {
            font-size: 14px;
            line-height: 1.5;
            color: var(--light-secondary-text);
        }

        body.dark-mode .channel-description {
            color: var(--dark-secondary-text);
        }

        /* ローディング */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 16px;
        }

        body.dark-mode .spinner {
            border-color: rgba(255, 255, 255, 0.1);
            border-top-color: var(--primary-color);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 16px;
            color: var(--light-secondary-text);
        }

        body.dark-mode .loading-text {
            color: var(--dark-secondary-text);
        }

        /* エラーメッセージ */
        .error-message {
            text-align: center;
            padding: 40px;
            background-color: rgba(255, 0, 0, 0.05);
            border-radius: 12px;
            margin: 20px 0;
        }

        body.dark-mode .error-message {
            background-color: rgba(255, 0, 0, 0.1);
        }

        .error-title {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 12px;
            color: #ff0000;
        }

        .error-text {
            font-size: 16px;
            color: var(--light-secondary-text);
            margin-bottom: 20px;
        }

        body.dark-mode .error-text {
            color: var(--dark-secondary-text);
        }

        /* フッター */
        footer {
            text-align: center;
            padding: 20px;
            font-size: 14px;
            color: var(--light-secondary-text);
            border-top: 1px solid var(--light-border);
            background-color: var(--light-bg);
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }

        body.dark-mode footer {
            background-color: var(--dark-bg);
            border-top-color: var(--dark-border);
            color: var(--dark-secondary-text);
        }

        /* レスポンシブ */
        @media (max-width: 768px) {
            .header-center {
                margin: 0 16px;
            }
            
            .sidebar {
                position: fixed;
                left: -240px;
                top: 56px;
                z-index: 99;
                transition: left 0.3s;
            }
            
            .sidebar.open {
                left: 0;
            }
            
            .content-area {
                padding: 10px;
            }
            
            .video-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
            
            .filter-container {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .date-filter {
                margin-left: 0;
                margin-top: 10px;
            }
        }

        /* ユーティリティクラス */
        .hidden {
            display: none !important;
        }

        .divider {
            height: 1px;
            background-color: var(--light-border);
            margin: 20px 0;
        }

        body.dark-mode .divider {
            background-color: var(--dark-border);
        }
    </style>
</head>
<body>
    <!-- 初期設定画面 -->
    <div id="setupScreen" class="setup-screen">
        <div class="setup-container">
            <h1 class="setup-title">YouTubeクローン - 初期設定</h1>
            
            <div class="setup-section">
                <h2 class="setup-section-title">APIキーを選択してください</h2>
                <div class="api-options">
                    <div class="api-option" data-api-key="AIzaSyCz7f0X_giaGyC9u1EfGZPBuAC9nXiL5Mo">
                        <span class="option-number">1</span>
                        <span>APIキー 1</span>
                    </div>
                    <div class="api-option" data-api-key="AIzaSyBmzCw7-sX1vm-uL_u2Qy3LuVZuxye4Wys">
                        <span class="option-number">2</span>
                        <span>APIキー 2</span>
                    </div>
                    <div class="api-option" data-api-key="AIzaSyBWScla0K91jUL6qQErctN9N2b3j9ds7HI">
                        <span class="option-number">3</span>
                        <span>APIキー 3</span>
                    </div>
                    <div class="api-option" data-api-key="AIzaSyA17CdOQtQRC3DQe7rgIzFwTUjwAy_3CAc">
                        <span class="option-number">4</span>
                        <span>APIキー 4</span>
                    </div>
                    <div class="api-option" data-api-key="AIzaSyDdk_yY0tN4gKsm4uyMYrIlv1RwXIYXrnw">
                        <span class="option-number">5</span>
                        <span>APIキー 5</span>
                    </div>
                    <div class="api-option" data-api-key="AIzaSyDeU5zpcth2OgXDfToyc7-QnSJsDc41UGk">
                        <span class="option-number">6</span>
                        <span>APIキー 6</span>
                    </div>
                    <div class="api-option" data-api-key="AIzaSyClu2V_22XpCG2GTe1euD35_Mh5bn4eTjA">
                        <span class="option-number">7</span>
                        <span>APIキー 7</span>
                    </div>
                </div>
            </div>
            
            <div class="setup-section">
                <h2 class="setup-section-title">動画プレイヤーのソースを選択してください</h2>
                <div class="player-source-options">
                    <div class="player-source-option" data-source-index="0">
                        <span class="option-number">1</span>
                        <span>プレイヤーソース 1</span>
                    </div>
                    <div class="player-source-option" data-source-index="1">
                        <span class="option-number">2</span>
                        <span>プレイヤーソース 2</span>
                    </div>
                    <div class="player-source-option" data-source-index="2">
                        <span class="option-number">3</span>
                        <span>プレイヤーソース 3</span>
                    </div>
                    <div class="player-source-option" data-source-index="3">
                        <span class="option-number">4</span>
                        <span>プレイヤーソース 4</span>
                    </div>
                    <div class="player-source-option" data-source-index="4">
                        <span class="option-number">5</span>
                        <span>プレイヤーソース 5</span>
                    </div>
                </div>
            </div>
            
            <button id="startBtn" class="setup-btn" disabled>YouTubeクローンを開始</button>
        </div>
    </div>

    <!-- メインアプリケーション -->
    <div id="app" class="container hidden">
        <!-- ヘッダー -->
        <header>
            <div class="header-left">
                <div class="menu-icon" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </div>
                <div class="logo-container" id="goHome">
                    <i class="fab fa-youtube logo-icon"></i>
                    <span class="logo-text">YouTube</span>
                    <span class="logo-subtitle">hgkf-Tube_v1</span>
                </div>
            </div>
            
            <div class="header-center">
                <div class="search-container">
                    <input type="text" class="search-input" id="searchInput" placeholder="検索">
                    <button class="search-btn" id="searchBtn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
            
            <div class="header-right">
                <div class="date-filter">
                    <select id="dateFilter">
                        <option value="">期間を選択</option>
                        <option value="today">今日</option>
                        <option value="this_week">今週</option>
                        <option value="this_month">今月</option>
                        <option value="this_year">今年</option>
                    </select>
                </div>
                
                <select class="api-selector" id="apiSelector">
                    <option value="">APIキー変更</option>
                    <option value="AIzaSyCz7f0X_giaGyC9u1EfGZPBuAC9nXiL5Mo">API 1</option>
                    <option value="AIzaSyBmzCw7-sX1vm-uL_u2Qy3LuVZuxye4Wys">API 2</option>
                    <option value="AIzaSyBWScla0K91jUL6qQErctN9N2b3j9ds7HI">API 3</option>
                    <option value="AIzaSyA17CdOQtQRC3DQe7rgIzFwTUjwAy_3CAc">API 4</option>
                    <option value="AIzaSyDdk_yY0tN4gKsm4uyMYrIlv1RwXIYXrnw">API 5</option>
                    <option value="AIzaSyDeU5zpcth2OgXDfToyc7-QnSJsDc41UGk">API 6</option>
                    <option value="AIzaSyClu2V_22XpCG2GTe1euD35_Mh5bn4eTjA">API 7</option>
                </select>
                
                <select class="player-source-selector" id="playerSourceSelector">
                    <option value="">プレイヤー変更</option>
                    <option value="0">ソース 1</option>
                    <option value="1">ソース 2</option>
                    <option value="2">ソース 3</option>
                    <option value="3">ソース 4</option>
                    <option value="4">ソース 5</option>
                </select>
                
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </header>
        
        <!-- 検索フィルター -->
        <div class="filter-container" id="filterContainer">
            <button class="filter-btn active">すべて</button>
            <button class="filter-btn">音楽</button>
            <button class="filter-btn">ゲーム</button>
            <button class="filter-btn">ライブ</button>
            <button class="filter-btn">最近アップロードされた動画</button>
            <button class="filter-btn">視聴済み</button>
            <button class="filter-btn">新しい動画</button>
        </div>
        
        <!-- メインコンテンツ -->
        <div class="main-content">
            <!-- サイドバー -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-item active" data-page="home">
                    <i class="fas fa-home"></i>
                    <span>ホーム</span>
                </div>
                <div class="divider"></div>
            </div>
            
            <!-- コンテンツエリア -->
            <div class="content-area" id="contentArea">
                <!-- ホームページコンテンツ -->
                <div id="homePage">
                    <div class="video-grid" id="videoGrid">
                        <!-- 動画カードがここに追加されます -->
                    </div>
                    <button class="load-more-btn" id="loadMoreVideos">もっと読み込む</button>
                </div>
                
                <!-- プレイヤーページ -->
                <div id="playerPage" class="player-page hidden">
                    <div class="player-container">
                        <div class="video-player" id="videoPlayer">
                            <!-- 動画プレイヤーがここに表示されます -->
                        </div>
                        
                        <div class="video-info-container">
                            <h1 id="videoTitle"></h1>
                            <div class="video-stats" id="videoStats"></div>
                            
                            <div class="channel-info" id="channelInfo">
                                <!-- チャンネル情報がここに表示されます -->
                            </div>
                            
                            <div class="video-description">
                                <h3 class="video-description-title">説明</h3>
                                <div class="video-description-text" id="videoDescription"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- チャンネルページ -->
                <div id="channelPage" class="hidden">
                    <div class="channel-header" id="channelHeader">
                        <!-- チャンネルヘッダーがここに表示されます -->
                    </div>
                    
                    <div class="channel-videos">
                        <h3 class="section-title">チャンネルの動画</h3>
                        <div class="video-grid" id="channelVideos">
                            <!-- チャンネル動画がここに表示されます -->
                        </div>
                        <button class="load-more-btn" id="loadMoreChannelVideos">もっと読み込む</button>
                    </div>
                </div>
                
                <!-- ローディング表示 -->
                <div id="loading" class="loading hidden">
                    <div class="spinner"></div>
                    <div class="loading-text">読み込み中...</div>
                </div>
                
                <!-- エラーメッセージ -->
                <div id="errorMessage" class="error-message hidden">
                    <h3 class="error-title">エラーが発生しました</h3>
                    <div class="error-text" id="errorText"></div>
                    <button class="load-more-btn" id="retryBtn">再試行</button>
                </div>
            </div>
        </div>
        
        <!-- フッター -->
        <footer>
            <p>© 2023 YouTubeクローン - 福原弘基が作成しました</p>
            <p>このサイトはYouTube Data API v3とYouTube Player for Educationを使用しています</p>
        </footer>
    </div>

    <script>
        // アプリケーションの状態
        const state = {
            apiKey: '',
            playerSources: [
                'https://raw.githubusercontent.com/siawaseok3/wakame/master/video_config.json',
                'https://raw.githubusercontent.com/wakame02/wktopu/refs/heads/main/edu.text',
                'https://raw.githubusercontent.com/woolisbest-4520/about-youtube/refs/heads/main/edu.json',
                'https://raw.githubusercontent.com/woolisbest-4520/about-youtube/refs/heads/main/parameter.json',
                'https://apis.kahoot.it/media-api/youtube/key'
            ],
            selectedPlayerSourceIndex: 0,
            playerParams: '',
            currentPage: 'home',
            searchQuery: '',
            dateFilter: '',
            nextPageTokens: {
                search: '',
                channel: ''
            },
            currentVideoId: '',
            currentChannelId: ''
        };

        // DOM要素
        const setupScreen = document.getElementById('setupScreen');
        const app = document.getElementById('app');
        const apiOptions = document.querySelectorAll('.api-option');
        const playerSourceOptions = document.querySelectorAll('.player-source-option');
        const startBtn = document.getElementById('startBtn');
        const apiSelector = document.getElementById('apiSelector');
        const playerSourceSelector = document.getElementById('playerSourceSelector');
        const themeToggle = document.getElementById('themeToggle');
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.getElementById('sidebar');
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const dateFilter = document.getElementById('dateFilter');
        const goHome = document.getElementById('goHome');
        const videoGrid = document.getElementById('videoGrid');
        const loadMoreVideos = document.getElementById('loadMoreVideos');
        const playerPage = document.getElementById('playerPage');
        const homePage = document.getElementById('homePage');
        const channelPage = document.getElementById('channelPage');
        const videoPlayer = document.getElementById('videoPlayer');
        const videoTitle = document.getElementById('videoTitle');
        const videoStats = document.getElementById('videoStats');
        const channelInfo = document.getElementById('channelInfo');
        const videoDescription = document.getElementById('videoDescription');
        const channelHeader = document.getElementById('channelHeader');
        const channelVideos = document.getElementById('channelVideos');
        const loadMoreChannelVideos = document.getElementById('loadMoreChannelVideos');
        const loading = document.getElementById('loading');
        const errorMessage = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');
        const retryBtn = document.getElementById('retryBtn');
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        const filterBtns = document.querySelectorAll('.filter-btn');

        // 初期化
        document.addEventListener('DOMContentLoaded', () => {
            // APIキー選択
            apiOptions.forEach(option => {
                option.addEventListener('click', () => {
                    apiOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    state.apiKey = option.dataset.apiKey;
                    updateStartButton();
                });
            });

            // プレイヤーソース選択
            playerSourceOptions.forEach(option => {
                option.addEventListener('click', () => {
                    playerSourceOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    state.selectedPlayerSourceIndex = parseInt(option.dataset.sourceIndex);
                    updateStartButton();
                });
            });

            // 開始ボタン
            startBtn.addEventListener('click', startApp);

            // APIセレクター変更
            apiSelector.addEventListener('change', (e) => {
                if (e.target.value) {
                    state.apiKey = e.target.value;
                    showMessage('APIキーを変更しました', 'success');
                    if (state.currentPage === 'player' && state.currentVideoId) {
                        loadVideoDetails(state.currentVideoId);
                    }
                }
            });

            // プレイヤーソースセレクター変更
            playerSourceSelector.addEventListener('change', (e) => {
                if (e.target.value !== '') {
                    state.selectedPlayerSourceIndex = parseInt(e.target.value);
                    showMessage('プレイヤーソースを変更しました', 'success');
                    if (state.currentPage === 'player' && state.currentVideoId) {
                        loadPlayerParams().then(() => {
                            playVideo(state.currentVideoId);
                        });
                    }
                }
            });

            // テーマ切り替え
            themeToggle.addEventListener('click', toggleTheme);

            // メニュートグル
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('open');
            });

            // 検索
            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') performSearch();
            });

            // 日付フィルター
            dateFilter.addEventListener('change', (e) => {
                state.dateFilter = e.target.value;
                if (state.searchQuery) {
                    performSearch();
                }
            });

            // ホームに戻る
            goHome.addEventListener('click', () => {
                showHomePage();
            });

            // もっと読み込むボタン
            loadMoreVideos.addEventListener('click', loadMoreContent);
            loadMoreChannelVideos.addEventListener('click', loadMoreChannelVideosFunc);

            // サイドバーナビゲーション
            sidebarItems.forEach(item => {
                item.addEventListener('click', () => {
                    const page = item.dataset.page;
                    navigateToPage(page);
                });
            });

            // フィルターボタン
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    // ここでフィルターを適用
                });
            });

            // 再試行ボタン
            retryBtn.addEventListener('click', () => {
                hideError();
                if (state.currentPage === 'player') {
                    loadVideoDetails(state.currentVideoId);
                } else if (state.currentPage === 'channel') {
                    loadChannelDetails(state.currentChannelId);
                } else {
                    loadHomeVideos();
                }
            });

            // プレイヤーパラメータを事前に取得
            loadPlayerParams();
        });

        // スタートボタンの更新
        function updateStartButton() {
            if (state.apiKey && state.selectedPlayerSourceIndex !== null) {
                startBtn.disabled = false;
            } else {
                startBtn.disabled = true;
            }
        }

        // アプリを開始
        function startApp() {
            setupScreen.classList.add('hidden');
            app.classList.remove('hidden');
            
            // プレイヤーパラメータを取得
            loadPlayerParams().then(() => {
                // ホームページの動画を読み込み
                loadHomeVideos();
            });
        }

        // テーマ切り替え
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const icon = themeToggle.querySelector('i');
            if (document.body.classList.contains('dark-mode')) {
                icon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'dark');
            } else {
                icon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'light');
            }
        }

        // プレイヤーパラメータの読み込み
        async function loadPlayerParams() {
            try {
                const response = await fetch(state.playerSources[state.selectedPlayerSourceIndex]);
                if (response.ok) {
                    const data = await response.text();
                    // JSONの場合とテキストの場合があるので処理を分ける
                    if (data.trim().startsWith('{')) {
                        const jsonData = JSON.parse(data);
                        state.playerParams = jsonData.params || '';
                    } else {
                        state.playerParams = data.trim();
                    }
                } else {
                    // デフォルトのパラメータを使用
                    state.playerParams = '?autoplay=1&controls=1&rel=0';
                }
            } catch (error) {
                console.error('プレイヤーパラメータの読み込みに失敗しました:', error);
                state.playerParams = '?autoplay=1&controls=1&rel=0';
            }
        }

        // ページナビゲーション
        function navigateToPage(page) {
            state.currentPage = page;
            
            // サイドバーのアクティブ状態を更新
            sidebarItems.forEach(item => {
                if (item.dataset.page === page) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // ページを表示
            if (page === 'home') {
                showHomePage();
            } else {
                // 他のページの処理
                showHomePage(); // 一時的にホームページを表示
            }
        }

        // ホームページを表示
        function showHomePage() {
            playerPage.classList.add('hidden');
            channelPage.classList.add('hidden');
            homePage.classList.remove('hidden');
            state.currentPage = 'home';
            
            if (videoGrid.children.length === 0) {
                loadHomeVideos();
            }
        }

        // ホーム動画の読み込み
        async function loadHomeVideos() {
            showLoading();
            hideError();
            
            try {
                // 人気動画を取得
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails&chart=mostPopular&maxResults=20&regionCode=JP&key=${state.apiKey}`
                );
                
                if (!response.ok) {
                    throw new Error(`APIエラー: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    displayVideos(data.items);
                } else {
                    throw new Error('動画が見つかりませんでした');
                }
            } catch (error) {
                showError(`動画の読み込みに失敗しました: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        // 動画を表示
        function displayVideos(videos, container = videoGrid, clear = true) {
            if (clear) {
                container.innerHTML = '';
            }
            
            videos.forEach(video => {
                const videoCard = createVideoCard(video);
                container.appendChild(videoCard);
            });
        }

        // 動画カードの作成
        function createVideoCard(video) {
            const videoId = video.id.videoId || video.id;
            const snippet = video.snippet;
            const statistics = video.statistics || {};
            const contentDetails = video.contentDetails || {};
            
            const card = document.createElement('div');
            card.className = 'video-card';
            card.dataset.videoId = videoId;
            
            // サムネイル
            const thumbnailUrl = snippet.thumbnails?.high?.url || snippet.thumbnails?.medium?.url || '';
            
            // 動画時間
            let duration = '';
            if (contentDetails.duration) {
                duration = formatDuration(contentDetails.duration);
            }
            
            // 視聴回数
            const viewCount = statistics.viewCount ? formatNumber(statistics.viewCount) + ' 回視聴' : '';
            
            // 投稿時間
            const publishedAt = timeAgo(snippet.publishedAt);
            
            card.innerHTML = `
                <div class="thumbnail-container">
                    <img src="${thumbnailUrl}" alt="${snippet.title}" class="video-thumbnail" onerror="this.src='https://via.placeholder.com/320x180?text=No+Thumbnail'">
                    ${duration ? `<span class="video-duration">${duration}</span>` : ''}
                </div>
                <div class="video-info">
                    <img src="${snippet.thumbnails?.default?.url || 'https://via.placeholder.com/36x36?text=CH'}" 
                         alt="${snippet.channelTitle}" 
                         class="channel-avatar"
                         onerror="this.src='https://via.placeholder.com/36x36?text=CH'">
                    <div class="video-details">
                        <h3 class="video-title">${snippet.title}</h3>
                        <div class="channel-name">${snippet.channelTitle}</div>
                        <div class="video-stats">
                            ${viewCount} • ${publishedAt}
                        </div>
                    </div>
                </div>
            `;
            
            card.addEventListener('click', () => playVideo(videoId));
            
            return card;
        }

        // 検索実行
        async function performSearch() {
            const query = searchInput.value.trim();
            if (!query) return;
            
            state.searchQuery = query;
            showLoading();
            hideError();
            
            try {
                // 日付フィルターの処理
                let publishedAfter = '';
                const now = new Date();
                
                if (state.dateFilter === 'today') {
                    const today = new Date(now);
                    today.setDate(today.getDate() - 1);
                    publishedAfter = today.toISOString();
                } else if (state.dateFilter === 'this_week') {
                    const weekAgo = new Date(now);
                    weekAgo.setDate(weekAgo.getDate() - 7);
                    publishedAfter = weekAgo.toISOString();
                } else if (state.dateFilter === 'this_month') {
                    const monthAgo = new Date(now);
                    monthAgo.setMonth(monthAgo.getMonth() - 1);
                    publishedAfter = monthAgo.toISOString();
                } else if (state.dateFilter === 'this_year') {
                    const yearAgo = new Date(now);
                    yearAgo.setFullYear(yearAgo.getFullYear() - 1);
                    publishedAfter = yearAgo.toISOString();
                }
                
                let url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=20&q=${encodeURIComponent(query)}&key=${state.apiKey}`;
                
                if (publishedAfter) {
                    url += `&publishedAfter=${publishedAfter}`;
                }
                
                if (state.nextPageTokens.search) {
                    url += `&pageToken=${state.nextPageTokens.search}`;
                }
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`検索エラー: ${response.status}`);
                }
                
                const data = await response.json();
                
                // 次のページトークンを保存
                state.nextPageTokens.search = data.nextPageToken || '';
                
                if (data.items && data.items.length > 0) {
                    // 動画の詳細情報を取得
                    const videoIds = data.items.map(item => item.id.videoId).join(',');
                    const detailsResponse = await fetch(
                        `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails&id=${videoIds}&key=${state.apiKey}`
                    );
                    
                    if (detailsResponse.ok) {
                        const detailsData = await detailsResponse.json();
                        displayVideos(detailsData.items);
                        loadMoreVideos.classList.remove('hidden');
                    } else {
                        throw new Error('動画詳細の取得に失敗しました');
                    }
                } else {
                    throw new Error('検索結果が見つかりませんでした');
                }
            } catch (error) {
                showError(`検索に失敗しました: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        // 動画を再生
        async function playVideo(videoId) {
            state.currentVideoId = videoId;
            
            // ページを切り替え
            homePage.classList.add('hidden');
            channelPage.classList.add('hidden');
            playerPage.classList.remove('hidden');
            state.currentPage = 'player';
            
            // サイドバーを閉じる（モバイルの場合）
            sidebar.classList.remove('open');
            
            showLoading();
            hideError();
            
            try {
                // プレイヤーパラメータを確認
                if (!state.playerParams) {
                    await loadPlayerParams();
                }
                
                // 動画プレイヤーを設定
                const playerUrl = `https://www.youtubeeducation.com/embed/${videoId}${state.playerParams}`;
                videoPlayer.innerHTML = `<iframe class="player-iframe" src="${playerUrl}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                
                // 動画の詳細情報を取得
                await loadVideoDetails(videoId);
                
            } catch (error) {
                showError(`動画の読み込みに失敗しました: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        // 動画詳細の読み込み
        async function loadVideoDetails(videoId) {
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails&id=${videoId}&key=${state.apiKey}`
                );
                
                if (!response.ok) {
                    throw new Error(`動画詳細の取得エラー: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const video = data.items[0];
                    const snippet = video.snippet;
                    const statistics = video.statistics;
                    const contentDetails = video.contentDetails;
                    
                    // タイトル
                    videoTitle.textContent = snippet.title;
                    
                    // 統計情報
                    const viewCount = formatNumber(statistics.viewCount);
                    const likeCount = formatNumber(statistics.likeCount || 0);
                    const publishedAt = new Date(snippet.publishedAt).toLocaleDateString('ja-JP');
                    
                    videoStats.innerHTML = `
                        <span>${viewCount} 回視聴</span> • 
                        <span>${likeCount} いいね</span> • 
                        <span>${publishedAt}</span>
                    `;
                    
                    // チャンネル情報
                    channelInfo.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                            <img src="${snippet.thumbnails?.default?.url || 'https://via.placeholder.com/40x40?text=CH'}" 
                                 alt="${snippet.channelTitle}" 
                                 class="channel-avatar"
                                 onerror="this.src='https://via.placeholder.com/40x40?text=CH'"
                                 style="cursor: pointer;"
                                 onclick="showChannel('${snippet.channelId}')">
                            <div>
                                <div style="font-weight: 500; cursor: pointer;" onclick="showChannel('${snippet.channelId}')">${snippet.channelTitle}</div>
                                <div style="font-size: 12px; color: var(--light-secondary-text);">${formatNumber(statistics.subscriberCount || 0)} 登録者</div>
                            </div>
                            <button style="margin-left: auto; padding: 8px 16px; background-color: #cc0000; color: white; border: none; border-radius: 20px; font-weight: 500; cursor: pointer;">登録する</button>
                        </div>
                    `;
                    
                    // 説明
                    videoDescription.textContent = snippet.description || '説明はありません';
                } else {
                    throw new Error('動画が見つかりませんでした');
                }
            } catch (error) {
                showError(`動画詳細の取得に失敗しました: ${error.message}`);
            }
        }

        // チャンネルを表示
        async function showChannel(channelId) {
            state.currentChannelId = channelId;
            
            // ページを切り替え
            homePage.classList.add('hidden');
            playerPage.classList.add('hidden');
            channelPage.classList.remove('hidden');
            state.currentPage = 'channel';
            
            // サイドバーを閉じる（モバイルの場合）
            sidebar.classList.remove('open');
            
            showLoading();
            hideError();
            
            try {
                await loadChannelDetails(channelId);
                await loadChannelVideos(channelId);
            } catch (error) {
                showError(`チャンネルの読み込みに失敗しました: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        // チャンネル詳細の読み込み
        async function loadChannelDetails(channelId) {
            try {
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${channelId}&key=${state.apiKey}`
                );
                
                if (!response.ok) {
                    throw new Error(`チャンネル詳細の取得エラー: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    const channel = data.items[0];
                    const snippet = channel.snippet;
                    const statistics = channel.statistics;
                    
                    channelHeader.innerHTML = `
                        <img src="${snippet.thumbnails?.high?.url || snippet.thumbnails?.default?.url || 'https://via.placeholder.com/100x100?text=CH'}" 
                             alt="${snippet.title}" 
                             class="channel-avatar-large"
                             onerror="this.src='https://via.placeholder.com/100x100?text=CH'">
                        <div class="channel-info">
                            <h1 class="channel-title">${snippet.title}</h1>
                            <div class="channel-stats">
                                <span>${snippet.customUrl || ''}</span>
                                <span>${formatNumber(statistics.subscriberCount || 0)} 登録者</span>
                                <span>${formatNumber(statistics.videoCount || 0)} 本の動画</span>
                            </div>
                            <div class="channel-description">${snippet.description || ''}</div>
                        </div>
                    `;
                } else {
                    throw new Error('チャンネルが見つかりませんでした');
                }
            } catch (error) {
                throw error;
            }
        }

        // チャンネル動画の読み込み
        async function loadChannelVideos(channelId, nextPageToken = '') {
            try {
                // チャンネルの動画を検索
                const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&type=video&order=date&maxResults=20&key=${state.apiKey}`;
                const response = await fetch(nextPageToken ? `${url}&pageToken=${nextPageToken}` : url);
                
                if (!response.ok) {
                    throw new Error(`チャンネル動画の取得エラー: ${response.status}`);
                }
                
                const data = await response.json();
                
                // 次のページトークンを保存
                state.nextPageTokens.channel = data.nextPageToken || '';
                
                if (data.items && data.items.length > 0) {
                    // 動画の詳細情報を取得
                    const videoIds = data.items.map(item => item.id.videoId).join(',');
                    const detailsResponse = await fetch(
                        `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails&id=${videoIds}&key=${state.apiKey}`
                    );
                    
                    if (detailsResponse.ok) {
                        const detailsData = await detailsResponse.json();
                        displayVideos(detailsData.items, channelVideos, nextPageToken === '');
                        
                        if (state.nextPageTokens.channel) {
                            loadMoreChannelVideos.classList.remove('hidden');
                        } else {
                            loadMoreChannelVideos.classList.add('hidden');
                        }
                    }
                } else {
                    channelVideos.innerHTML = '<p>動画はありません</p>';
                    loadMoreChannelVideos.classList.add('hidden');
                }
            } catch (error) {
                throw error;
            }
        }

        // もっと読み込む機能
        async function loadMoreContent() {
            if (!state.searchQuery) {
                // ホームの動画をさらに読み込む
                await loadHomeVideos(false);
            } else {
                // 検索結果をさらに読み込む
                await performSearch(false);
            }
        }

        // チャンネル動画をもっと読み込む
        async function loadMoreChannelVideosFunc() {
            if (state.nextPageTokens.channel) {
                await loadChannelVideos(state.currentChannelId, state.nextPageTokens.channel);
            }
        }

        // ユーティリティ関数
        function formatNumber(num) {
            if (!num) return '0';
            if (num >= 1000000000) {
                return (num / 1000000000).toFixed(1).replace(/\.0$/, '') + 'B';
            }
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1).replace(/\.0$/, '') + 'M';
            }
            if (num >= 1000) {
                return (num / 1000).toFixed(1).replace(/\.0$/, '') + 'K';
            }
            return num.toString();
        }

        function formatDuration(duration) {
            const match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
            if (!match) return '';
            
            const hours = (match[1] || '').replace('H', '');
            const minutes = (match[2] || '').replace('M', '');
            const seconds = (match[3] || '').replace('S', '');
            
            let result = '';
            if (hours) {
                result += hours + ':';
                result += minutes.padStart(2, '0') + ':';
            } else {
                result += minutes + ':';
            }
            result += seconds.padStart(2, '0');
            
            return result;
        }

        function timeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const seconds = Math.floor((now - date) / 1000);
            
            if (seconds < 60) return 'たった今';
            
            const minutes = Math.floor(seconds / 60);
            if (minutes < 60) return `${minutes} 分前`;
            
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours} 時間前`;
            
            const days = Math.floor(hours / 24);
            if (days < 30) return `${days} 日前`;
            
            const months = Math.floor(days / 30);
            if (months < 12) return `${months} か月前`;
            
            const years = Math.floor(months / 12);
            return `${years} 年前`;
        }

        function showLoading() {
            loading.classList.remove('hidden');
        }

        function hideLoading() {
            loading.classList.add('hidden');
        }

        function showError(message) {
            errorText.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        function hideError() {
            errorMessage.classList.add('hidden');
        }

        function showMessage(message, type = 'info') {
            // シンプルなメッセージ表示
            alert(message);
        }

        // グローバル関数
        window.showChannel = showChannel;

        // ローカルストレージからテーマを読み込む
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            const icon = themeToggle.querySelector('i');
            icon.className = 'fas fa-sun';
        }
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"94c79d4d951745d085049dd7f2bbd8f8","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
